<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Function Properties in Data Classes are Code Smells | Marcello Galhardo</title>
<meta name=keywords content="android,kotlin,kmp"><meta name=description content="To me, using functions as properties in the primary constructor of a data class is a code smell. Here&rsquo;s why:
Data classes represent data. Data is a value. Data is never executed. Functions are not data. They produce values when executed. Note: By the book, a function returns a value, while a procedure executes commands. In both cases, neither is data.
Why It Matters Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:"><meta name=author content><link rel=canonical href=https://marcellogalhardo.dev/posts/function-properties-in-data-classes-are-code-smells/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://marcellogalhardo.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://marcellogalhardo.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://marcellogalhardo.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://marcellogalhardo.dev/apple-touch-icon.png><link rel=mask-icon href=https://marcellogalhardo.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://marcellogalhardo.dev/posts/function-properties-in-data-classes-are-code-smells/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-7LK7ENB813"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7LK7ENB813",{anonymize_ip:!1})}</script><meta property="og:title" content="Function Properties in Data Classes are Code Smells"><meta property="og:description" content="To me, using functions as properties in the primary constructor of a data class is a code smell. Here&rsquo;s why:
Data classes represent data. Data is a value. Data is never executed. Functions are not data. They produce values when executed. Note: By the book, a function returns a value, while a procedure executes commands. In both cases, neither is data.
Why It Matters Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:"><meta property="og:type" content="article"><meta property="og:url" content="https://marcellogalhardo.dev/posts/function-properties-in-data-classes-are-code-smells/"><meta property="og:image" content="https://marcellogalhardo.dev/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-29T16:09:00+01:00"><meta property="article:modified_time" content="2024-11-29T16:09:00+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://marcellogalhardo.dev/logo.png"><meta name=twitter:title content="Function Properties in Data Classes are Code Smells"><meta name=twitter:description content="To me, using functions as properties in the primary constructor of a data class is a code smell. Here&rsquo;s why:
Data classes represent data. Data is a value. Data is never executed. Functions are not data. They produce values when executed. Note: By the book, a function returns a value, while a procedure executes commands. In both cases, neither is data.
Why It Matters Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://marcellogalhardo.dev/posts/"},{"@type":"ListItem","position":2,"name":"Function Properties in Data Classes are Code Smells","item":"https://marcellogalhardo.dev/posts/function-properties-in-data-classes-are-code-smells/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Function Properties in Data Classes are Code Smells","name":"Function Properties in Data Classes are Code Smells","description":"To me, using functions as properties in the primary constructor of a data class is a code smell. Here\u0026rsquo;s why:\nData classes represent data. Data is a value. Data is never executed. Functions are not data. They produce values when executed. Note: By the book, a function returns a value, while a procedure executes commands. In both cases, neither is data.\nWhy It Matters Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:","keywords":["android","kotlin","kmp"],"articleBody":"To me, using functions as properties in the primary constructor of a data class is a code smell. Here’s why:\nData classes represent data. Data is a value. Data is never executed. Functions are not data. They produce values when executed. Note: By the book, a function returns a value, while a procedure executes commands. In both cases, neither is data.\nWhy It Matters Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:\nequals() and hashCode() for comparing instances. toString() for readable output like \"Person(name=John Doe, age=30)\". When you add functions as properties, you breaks the data class contract of holding only data, and these generated methods will misbehave.\nExample: Data vs. Functions Expected Behavior: Data Class with Data. data class Person( val name: String, val surname: String, val age: Int, ) val p1 = Person(\"John\", \"Doe\", 30) // Person(name=John, surname=Doe, age=30) val p2 = Person(\"John\", \"Doe\", 30) // Person(name=John, surname=Doe, age=30) val p2 = Person(\"John\", \"Doe\", 44) // Person(name=John, surname=Doe, age=44) // equals println(p1 == p2) // true println(p2 == p3) // false // hashCode println(p1.hashCode() == p2.hashCode()) // true println(p2.hashCode() == p3.hashCode()) // false // toString println(p1.toString() == p2.toString()) // true println(p2.toString() == p3.toString()) // false Unexpected Behavior: Data Class with Functions data class UiState( val people: List, val eventSink: (UiEvent) -\u003e Unit, ) sealed class UiEvent val s1 = UiState(listOf(), eventSink = {}) // UiState(people=[], eventSink=Function1) val s2 = UiState(listOf(), eventSink = {}) // UiState(people=[], eventSink=Function1) val s3 = UiState(listOf(), eventSink = { println(\"Effect\") }) // UiState(people=[], eventSink=Function1) // equals println(s1 == s2) // false println(s2 == s3) // false // hashCode println(s1.hashCode() == s2.hashCode()) // false println(s2.hashCode() == s3.hashCode()) // false // toString println(s1.toString() == s2.toString()) // false println(s2.toString() == s3.toString()) // false You can find the example above at this link.\nIssues in Detail Equality (equals): Functions are never equal, even if they are duplicates of each other. Hash Codes (hashCode): Different instances with same data generates different hashes. String Representation (toString): Functions produce generic output, leading to misleading comparisons. For example, using an assertion library? You might encounter:\n“(non-equal value with same string representation)”\nThis happens because function properties can’t be meaningfully compared or represented, causing equals and toString to behave unpredictably.\nThe Solution Use data classes only for data. If you need to include functions or behaviors like callbacks:\nUse a regular class. Override equals(), hashCode(), and toString() manually. By using a regular class, you clarify intent, avoid unintended behavior from generated methods, and uphold the principle that data classes should only hold data.\nReferences Kotlin Data Classes Documentation A Curious Case of Mistaken Identity ","wordCount":"443","inLanguage":"en","image":"https://marcellogalhardo.dev/logo.png","datePublished":"2024-11-29T16:09:00+01:00","dateModified":"2024-11-29T16:09:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://marcellogalhardo.dev/posts/function-properties-in-data-classes-are-code-smells/"},"publisher":{"@type":"Organization","name":"Marcello Galhardo","logo":{"@type":"ImageObject","url":"https://marcellogalhardo.dev/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://marcellogalhardo.dev/ accesskey=h title="Marcello Galhardo (Alt + H)">Marcello Galhardo</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://marcellogalhardo.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://marcellogalhardo.dev/talks title=Talks><span>Talks</span></a></li><li><a href=https://marcellogalhardo.dev/about title=About><span>About</span></a></li><li><a href=https://marcellogalhardo.dev/uses title=Uses><span>Uses</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Function Properties in Data Classes are Code Smells</h1><div class=post-meta><span title='2024-11-29 16:09:00 +0100 +0100'>November 29, 2024</span></div></header><div class=post-content><p>To me, using functions as properties in the primary constructor of a data class is a <strong>code smell</strong>. Here&rsquo;s why:</p><ul><li><strong>Data classes represent data.</strong> Data is a value. Data is never executed.</li><li><strong>Functions are not data.</strong> They produce values when executed.</li></ul><p><strong>Note:</strong> By the book, a <strong>function</strong> returns a value, while a <strong>procedure</strong> executes commands. In both cases, <strong>neither is data</strong>.</p><h3 id=why-it-matters>Why It Matters<a hidden class=anchor aria-hidden=true href=#why-it-matters>#</a></h3><p>Kotlin generates key methods for data classes based on the properties in the primary constructor, such as:</p><ul><li><code>equals()</code> and <code>hashCode()</code> for comparing instances.</li><li><code>toString()</code> for readable output like <code>"Person(name=John Doe, age=30)"</code>.</li></ul><p>When you add functions as properties, you breaks the <code>data class</code> contract of holding only data, and these generated methods will misbehave.</p><h3 id=example-data-vs-functions>Example: Data vs. Functions<a hidden class=anchor aria-hidden=true href=#example-data-vs-functions>#</a></h3><h4 id=expected-behaviordata-class-with-data>Expected Behavior: Data Class with Data.<a hidden class=anchor aria-hidden=true href=#expected-behaviordata-class-with-data>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span>(
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>val</span> name: String,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>val</span> surname: String,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>val</span> age: Int,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>val</span> p1 = Person(<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Doe&#34;</span>, <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// Person(name=John, surname=Doe, age=30)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> p2 = Person(<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Doe&#34;</span>, <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// Person(name=John, surname=Doe, age=30)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> p2 = Person(<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Doe&#34;</span>, <span style=color:#ae81ff>44</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// Person(name=John, surname=Doe, age=44)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// equals
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p1 <span style=color:#f92672>==</span> p2) <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p2 <span style=color:#f92672>==</span> p3) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// hashCode
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p1.hashCode() <span style=color:#f92672>==</span> p2.hashCode()) <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p2.hashCode() <span style=color:#f92672>==</span> p3.hashCode()) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// toString
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p1.toString() <span style=color:#f92672>==</span> p2.toString()) <span style=color:#75715e>// true 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(p2.toString() <span style=color:#f92672>==</span> p3.toString()) <span style=color:#75715e>// false
</span></span></span></code></pre></div><h4 id=unexpected-behaviordata-class-with-functions>Unexpected Behavior: Data Class with Functions<a hidden class=anchor aria-hidden=true href=#unexpected-behaviordata-class-with-functions>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UiState</span>(
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>val</span> people: List&lt;Person&gt;,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>val</span> eventSink: (UiEvent) <span style=color:#f92672>-&gt;</span> Unit,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>sealed</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>UiEvent</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>val</span> s1 = UiState(listOf(), eventSink = {})
</span></span><span style=display:flex><span><span style=color:#75715e>// UiState(people=[], eventSink=Function1&lt;UiEvent, kotlin.Unit&gt;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> s2 = UiState(listOf(), eventSink = {})
</span></span><span style=display:flex><span><span style=color:#75715e>// UiState(people=[], eventSink=Function1&lt;UiEvent, kotlin.Unit&gt;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>val</span> s3 = UiState(listOf(), eventSink = { println(<span style=color:#e6db74>&#34;Effect&#34;</span>) })
</span></span><span style=display:flex><span><span style=color:#75715e>// UiState(people=[], eventSink=Function1&lt;UiEvent, kotlin.Unit&gt;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// equals
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s1 <span style=color:#f92672>==</span> s2) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s2 <span style=color:#f92672>==</span> s3) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// hashCode
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s1.hashCode() <span style=color:#f92672>==</span> s2.hashCode()) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s2.hashCode() <span style=color:#f92672>==</span> s3.hashCode()) <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// toString
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s1.toString() <span style=color:#f92672>==</span> s2.toString()) <span style=color:#75715e>// false 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>println(s2.toString() <span style=color:#f92672>==</span> s3.toString()) <span style=color:#75715e>// false
</span></span></span></code></pre></div><p>You can find the example above at <a href=https://pl.kotl.in/pZmKMjxCy>this link</a>.</p><h3 id=issues-in-detail>Issues in Detail<a hidden class=anchor aria-hidden=true href=#issues-in-detail>#</a></h3><ol><li><strong>Equality (<code>equals</code>)</strong>: Functions are never equal, even if they are duplicates of each other. </li><li><strong>Hash Codes (<code>hashCode</code>)</strong>: Different instances with same data generates different hashes.</li><li><strong>String Representation (<code>toString</code>)</strong>: Functions produce generic output, leading to misleading comparisons.</li></ol><p>For example, using an assertion library? You might encounter:</p><blockquote><p>&ldquo;(non-equal value with same string representation)&rdquo;</p></blockquote><p>This happens because function properties can&rsquo;t be meaningfully compared or represented, causing <code>equals</code> and <code>toString</code> to behave unpredictably.</p><h3 id=the-solution>The Solution<a hidden class=anchor aria-hidden=true href=#the-solution>#</a></h3><p><strong>Use data classes only for data.</strong> If you need to include functions or behaviors like callbacks:</p><ul><li>Use a regular <code>class</code>.</li><li>Override <code>equals()</code>, <code>hashCode()</code>, and <code>toString()</code> manually.</li></ul><p>By using a regular class, you clarify intent, avoid unintended behavior from generated methods, and uphold the principle that <strong>data classes should only hold data</strong>.</p><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li><a href=https://kotlinlang.org/docs/data-classes.html>Kotlin Data Classes Documentation</a></li><li><a href=https://blog.mmckenna.me/a-curious-case-of-mistaken-identity>A Curious Case of Mistaken Identity</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://marcellogalhardo.dev/tags/android/>Android</a></li><li><a href=https://marcellogalhardo.dev/tags/kotlin/>Kotlin</a></li><li><a href=https://marcellogalhardo.dev/tags/kmp/>Kmp</a></li></ul></footer></article></main><footer class=footer><span>CC BY-NC 4.0</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>