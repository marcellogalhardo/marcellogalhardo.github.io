<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Trampoline Activities | Marcello Galhardo</title><meta name=keywords content="android"><meta name=description content="Today, I came across the term &ldquo;Trampoline Activities&rdquo;. Although it&rsquo;s not an official name (or is it?), I&rsquo;ve noticed it is a typical pattern and have decided to make a &ldquo;How To&rdquo; guide.
What are Trampoline Activities? A Trampoline Activity is an Activity that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next Activity."><meta name=author content><link rel=canonical href=https://marcellogalhardo.dev/posts/2023/trampoline-activities/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://marcellogalhardo.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://marcellogalhardo.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://marcellogalhardo.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://marcellogalhardo.dev/apple-touch-icon.png><link rel=mask-icon href=https://marcellogalhardo.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-7LK7ENB813"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7LK7ENB813",{anonymize_ip:!1})}</script><meta property="og:title" content="Trampoline Activities"><meta property="og:description" content="Today, I came across the term &ldquo;Trampoline Activities&rdquo;. Although it&rsquo;s not an official name (or is it?), I&rsquo;ve noticed it is a typical pattern and have decided to make a &ldquo;How To&rdquo; guide.
What are Trampoline Activities? A Trampoline Activity is an Activity that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next Activity."><meta property="og:type" content="article"><meta property="og:url" content="https://marcellogalhardo.dev/posts/2023/trampoline-activities/"><meta property="og:image" content="https://marcellogalhardo.dev/images/logo.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-06T09:02:50+01:00"><meta property="article:modified_time" content="2023-03-06T09:02:50+01:00"><meta property="og:site_name" content="Marcello Galhardo"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://marcellogalhardo.dev/images/logo.jpg"><meta name=twitter:title content="Trampoline Activities"><meta name=twitter:description content="Today, I came across the term &ldquo;Trampoline Activities&rdquo;. Although it&rsquo;s not an official name (or is it?), I&rsquo;ve noticed it is a typical pattern and have decided to make a &ldquo;How To&rdquo; guide.
What are Trampoline Activities? A Trampoline Activity is an Activity that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next Activity."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://marcellogalhardo.dev/posts/"},{"@type":"ListItem","position":2,"name":"Trampoline Activities","item":"https://marcellogalhardo.dev/posts/2023/trampoline-activities/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Trampoline Activities","name":"Trampoline Activities","description":"Today, I came across the term \u0026ldquo;Trampoline Activities\u0026rdquo;. Although it\u0026rsquo;s not an official name (or is it?), I\u0026rsquo;ve noticed it is a typical pattern and have decided to make a \u0026ldquo;How To\u0026rdquo; guide.\nWhat are Trampoline Activities? A Trampoline Activity is an Activity that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next Activity.","keywords":["android"],"articleBody":"Today, I came across the term “Trampoline Activities”. Although it’s not an official name (or is it?), I’ve noticed it is a typical pattern and have decided to make a “How To” guide.\nWhat are Trampoline Activities? A Trampoline Activity is an Activity that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next Activity.\nHere is an example: Trampoline Activity.\nHow to create a Trampoline Activity? To create a Trampoline Activity, you need an activity without a UI that closes itself and moves on to the next activity. The key is to use the NoDisplay theme to remove the UI:\n  android:name=\".MyTrampolineActivity\"  android:theme=\"@android:style/Theme.NoDisplay\" / You can write your logic in the onCreate method of MyTrampolineActivity and launch the next activity as soon as possible. Remember to finish the MyTrampolineActivity at the end of the onCreate method:\nclass MyTrampolineActivity : Activity() {  fun onCreate() {  super.onCreate()  // Start your next activity.  finish()  } } Note that the NoDisplay theme means no UI, including toasts or dialogs. If you don’t call finish() before onResume() completes, the activity will crash on any Android 23+ device. The behaviour is intentional, as you can see here and here:\n PSA: The new requirement to immediately finish an activity if using Theme.NoDisplay is not a regression, this has always been a requirement of it (see https://developer.android.com/reference/android/R.style.html#Theme_NoDisplay for example).\nThe reason the platform in M is now crashing the app if it doesn’t use this is because not using it would previously break in very subtle and mysterious ways. For example, you would sometimes end up with your app ANRing for no reason.\n If you want a transparent Activity, consider using the Translucent theme instead.\n When should you use a Trampoline Activity? Avoid using Trampoline Activities in every situation (or even better, use a Single Activity) and always consider alternative solutions before relying on them. However, there are some scenarios in which it can be helpful, including:\n When you need to access Activity context APIs, from a different context. When you want to transform or sanitize parameters, before passing them forward to the next Activity. When you need to perform conditional routing logic between multiple activities.    ℹ️ To stay up to date with my writing, follow me on Twitter or Mastodon. If you have any questions or I missed something, feel free to reach out to me! ℹ️\n ","wordCount":"408","inLanguage":"en","datePublished":"2023-03-06T09:02:50+01:00","dateModified":"2023-03-06T09:02:50+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://marcellogalhardo.dev/posts/2023/trampoline-activities/"},"publisher":{"@type":"Organization","name":"Marcello Galhardo","logo":{"@type":"ImageObject","url":"https://marcellogalhardo.dev/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://marcellogalhardo.dev/ accesskey=h title="Marcello Galhardo (Alt + H)">Marcello Galhardo</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://marcellogalhardo.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://marcellogalhardo.dev/talks title=Talks><span>Talks</span></a></li><li><a href=https://marcellogalhardo.dev/about title=About><span>About</span></a></li><li><a href=https://marcellogalhardo.dev/uses title=Uses><span>Uses</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Trampoline Activities</h1><div class=post-meta><span title="2023-03-06 09:02:50 +0100 +0100">March 6, 2023</span></div></header><div class=post-content><p>Today, I came across the term &ldquo;Trampoline Activities&rdquo;. Although it&rsquo;s not an official name (<a href=https://developer.android.com/about/versions/12/behavior-changes-12#notification-trampolines>or is it</a>?), I&rsquo;ve noticed it is a typical pattern and have decided to make a &ldquo;How To&rdquo; guide.</p><h2 id=what-are-trampoline-activities>What are Trampoline Activities?<a hidden class=anchor aria-hidden=true href=#what-are-trampoline-activities>#</a></h2><p>A Trampoline Activity is an <code>Activity</code> that launches another activity and finishes itself. It may include conditional logic to determine which activity to launch or transforming the parameters before sending it to the next <code>Activity</code>.</p><p>Here is an example: <a href=https://android.googlesource.com/platform/packages/apps/ManagedProvisioning/+/b949b1f/src/com/android/managedprovisioning/TrampolineActivity.java>Trampoline Activity</a>.</p><h2 id=how-to-create-a-trampoline-activity>How to create a Trampoline Activity?<a hidden class=anchor aria-hidden=true href=#how-to-create-a-trampoline-activity>#</a></h2><p>To create a Trampoline Activity, you need an activity without a UI that closes itself and moves on to the next activity. The key is to use the <code>NoDisplay</code> theme to remove the UI:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;activity</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>android:name=</span><span style=color:#e6db74>&#34;.MyTrampolineActivity&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>android:theme=</span><span style=color:#e6db74>&#34;@android:style/Theme.NoDisplay&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span></code></pre></div><p>You can write your logic in the <code>onCreate</code> method of <code>MyTrampolineActivity</code> and launch the next activity as soon as possible. Remember to finish the <code>MyTrampolineActivity</code> at the end of the <code>onCreate</code> method:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyTrampolineActivity</span> : Activity() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>onCreate</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>super</span>.onCreate()
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Start your next activity.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    finish()
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that the <code>NoDisplay</code> theme means no UI, including toasts or dialogs. If you don&rsquo;t call <code>finish()</code> before <code>onResume()</code> completes, the activity will crash on any Android 23+ device. The behaviour is intentional, as you can see <a href="https://web.archive.org/web/20151116170752/https://code.google.com/p/android-developer-preview/issues/detail?id=2353">here</a> and here:</p><blockquote><p>PSA: The new requirement to immediately finish an activity if using Theme.NoDisplay is not a regression, this has always been a requirement of it (see <a href=https://developer.android.com/reference/android/R.style.html#Theme_NoDisplay>https://developer.android.com/reference/android/R.style.html#Theme_NoDisplay</a> for example).</p><p>The reason the platform in M is now crashing the app if it doesn&rsquo;t use this is because not using it would previously break in very subtle and mysterious ways. For example, you would sometimes end up with your app ANRing for no reason.</p></blockquote><p>If you want a transparent <code>Activity</code>, consider using the <code>Translucent</code> theme instead.</p><hr><h2 id=when-should-you-use-a-trampoline-activity>When should you use a Trampoline Activity?<a hidden class=anchor aria-hidden=true href=#when-should-you-use-a-trampoline-activity>#</a></h2><p>Avoid using Trampoline Activities in every situation (or even better, use a <a href="https://www.youtube.com/watch?v=2k8x8V77CrU">Single Activity</a>) and always consider alternative solutions before relying on them. However, there are some scenarios in which it can be helpful, including:</p><ul><li>When you need to access Activity context APIs, from a different context.</li><li>When you want to transform or sanitize parameters, before passing them forward to the next Activity.</li><li>When you need to perform conditional routing logic between multiple activities.</li></ul><hr><blockquote><p>ℹ️ To stay up to date with my writing, follow me on <a href=https://twitter.com/marcellogalhard>Twitter</a> or <a href=http://androiddev.social/@mg>Mastodon</a>. If you have any questions or I missed something, feel free to reach out to me! ℹ️</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://marcellogalhardo.dev/tags/android/>android</a></li></ul></footer></article></main><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2023</span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span><span><a href=https://marcellogalhardo.dev/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></body></html>