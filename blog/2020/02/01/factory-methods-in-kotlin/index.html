<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="When talking about Factory Methods extension functions tends to be favored in Kotlin - but it might be a challenge to name these functions in a discoverable way without polluting your classpath. Therefore, we can get inspiration on Kotlin&amp;rsquo;s Standard library to improve our naming.
Wrapping an instance If your intention is to get a given instance, for example javax.inject.Provider, create an instance of ViewModelProvider.Factory which internally uses it: you want a wrapper."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://marcellogalhardo.dev/blog/2020/02/01/factory-methods-in-kotlin/><title>Factory Methods in Kotlin :: Marcello Galhardo â€” Senior Software Engineer @ N26</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css><meta itemprop=name content="Factory Methods in Kotlin"><meta itemprop=description content="When talking about Factory Methods extension functions tends to be favored in Kotlin - but it might be a challenge to name these functions in a discoverable way without polluting your classpath. Therefore, we can get inspiration on Kotlin&rsquo;s Standard library to improve our naming.
Wrapping an instance If your intention is to get a given instance, for example javax.inject.Provider, create an instance of ViewModelProvider.Factory which internally uses it: you want a wrapper."><meta itemprop=datePublished content="2020-02-01T09:02:50+01:00"><meta itemprop=dateModified content="2020-02-01T09:02:50+01:00"><meta itemprop=wordCount content="388"><meta itemprop=image content="https://marcellogalhardo.dev/"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://marcellogalhardo.dev/"><meta name=twitter:title content="Factory Methods in Kotlin"><meta name=twitter:description content="When talking about Factory Methods extension functions tends to be favored in Kotlin - but it might be a challenge to name these functions in a discoverable way without polluting your classpath. Therefore, we can get inspiration on Kotlin&rsquo;s Standard library to improve our naming.
Wrapping an instance If your intention is to get a given instance, for example javax.inject.Provider, create an instance of ViewModelProvider.Factory which internally uses it: you want a wrapper."><meta property="article:published_time" content="2020-02-01 09:02:50 +0100 +0100"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>marcellogalhardo.dev</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/blog/>Blog</a></li><li><a href=/talks>Talks</a></li><li><a href=/about>About</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://marcellogalhardo.dev/blog/2020/02/01/factory-methods-in-kotlin/>Factory Methods in Kotlin</a></h2><div class=post-content><p>When talking about Factory Methods extension functions tends to be favored in Kotlin - but it might be a challenge to name these functions in a discoverable way without polluting your classpath. Therefore, we can get inspiration on Kotlin&rsquo;s Standard library to improve our naming.</p><h2 id=wrapping-an-instance>Wrapping an instance</h2><p>If your intention is to get a given instance, for example <code>javax.inject.Provider</code>, create an instance of <code>ViewModelProvider.Factory</code> which internally uses it: you want a wrapper. Looking inside Kotlin&rsquo;s Standard library we can find <a href=https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/as-executor.html>asExecutor</a> which does exactly the same.</p><p>That said, a good way of doing it is:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>fun</span> &lt;<span style=color:#a6e22e>VM</span> : <span style=color:#a6e22e>ViewModel</span>&gt; <span style=color:#a6e22e>Provider</span>&lt;<span style=color:#66d9ef>out</span> VM&gt;.asViewModelFactory(): ViewModelProvider.Factory {
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>object</span> <span style=color:#960050;background-color:#1e0010>: </span><span style=color:#a6e22e>ViewModelProvider</span>.Factory {
        <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> &lt;<span style=color:#a6e22e>T</span> : <span style=color:#a6e22e>ViewModel</span>?&gt; <span style=color:#a6e22e>create</span>(modelClass: Class&lt;T&gt;): T {
            <span style=color:#a6e22e>@Suppress</span>(<span style=color:#e6db74>&#34;UNCHECKED_CAST&#34;</span>)
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>get</span>() <span style=color:#66d9ef>as</span> T
        }
    }
}
</code></pre></div><h2 id=mapping-data>Mapping data</h2><p>When your intention is to copy the data of a given instance, for example <code>UserDto</code>, into a new instance like <code>User</code> (domain model): you want a mapper. Again, Kotlin&rsquo;s Standard library give us a good example with <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/to-list.html?_ga=2.130355144.672183661.1577982073-802284527.1577800392">toList</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>UserDto</span>.toUser(): User {
    <span style=color:#66d9ef>return</span> User(
        name = Name(
            first = <span style=color:#66d9ef>this</span>.firstName,
            last = <span style=color:#66d9ef>this</span>.lastName
        ),
        email = Email(<span style=color:#66d9ef>this</span>.email)
        age = <span style=color:#66d9ef>this</span>.age
    )
}
</code></pre></div><h2 id=vararg-constructors>Vararg constructors</h2><p>Maybe you want to provide a secondary constructor which accept a vararg of that list of parameters but you don&rsquo;t want to pollute your class code which such a small and optional thing. Kotlin&rsquo;s Standard Library offer us the convenient <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/list-of.html?_ga=2.139095028.672183661.1577982073-802284527.1577800392">listOf</a> as an example.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>fun</span> &lt;<span style=color:#a6e22e>T</span> : <span style=color:#a6e22e>Controller</span>&gt; <span style=color:#a6e22e>compositeControllerOf</span>(<span style=color:#66d9ef>vararg</span> providers: Provider&lt;T&gt;) = 
    CompositeControllerFactory(providers.toList())
</code></pre></div><h2 id=builders>Builders</h2><p>Last but not least, Kotlin&rsquo;s constructor combined with named parameter covers most use cases of the Builder Design Pattern. However, sometimes you might want to create an instance which constructors are not suitable - for example, with a lot of optionals and configurable attributes where you want to provide alternative combinations (maybe accepting URL or URI). For that cases, we can use <a href=https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.text/build-string.html>buildString</a> as an example.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>buildImageLoader</span>(
    builderAction: ImageLoaderBuilder.() <span style=color:#f92672>-&gt;</span> Unit
): String

<span style=color:#75715e>// usage example
</span><span style=color:#75715e></span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>val</span> validUri = <span style=color:#75715e>// receives a valid URI object
</span><span style=color:#75715e></span>    buildImageLoader {
        uri = validUri
        loadingPlaceholder = R.drawable.loading_placeholder
        errorPlaceholder = R.drawable.error_placeholder
    }
}
</code></pre></div><h1 id=conclusion>Conclusion</h1><p>As you can see, the Kotlin Standard library can be a good source of inspiration when designing code aiming for better discoverability between Kotlin Developers through the consistent pattern the language follows. Why not take advantage of that?</p></div></article><hr><div class=post-info></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span><span><a href=https://marcellogalhardo.dev/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js integrity="sha512-LOZOpupEpysT3YEvwutcyj7+h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script></body></html>